"0",""
"0","#more advanced map with home wins/losses marked with different marker icons, and temperature color "
"0",""
"0","library(leaflet)"
"0","library(dplyr)"
"0","library(readr)"
"0",""
"0","# Load data"
"0","games <- read_csv(""spreadspoke_scores.csv"")"
"1","[1mRows: [22m[34m14086[39m [1mColumns: [22m[34m17[39m
"
"1","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (7): schedule_date, schedule_week, t...
[32mdbl[39m (8): schedule_season, score_home, sc...
[33mlgl[39m (2): schedule_playoff, stadium_neutral
"
"1","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.
"
"0","stadium_coords <- read_csv(""stadiums.csv"")"
"1","[1mRows: [22m[34m12[39m [1mColumns: [22m[34m3[39m
"
"1","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (1): stadium
[32mdbl[39m (2): latitude, longitude
"
"1","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.
"
"0","# Merge and calculate home win"
"0","games_geo <- games %>%"
"0","  filter(!is.na(weather_temperature)) %>%"
"0","  left_join(stadium_coords, by = ""stadium"") %>%"
"0","  filter(!is.na(latitude) & !is.na(longitude)) %>%"
"0","  mutate("
"0","    home_win = score_home > score_away,"
"0","    result_color = ifelse(home_win, ""magenta"", ""black""),"
"0","    wind_scaled = pmax(weather_wind_mph / 2, 3)"
"0","  )"
"0",""
"0","# Temperature color palette"
"0","temp_pal <- colorNumeric(""RdYlBu"", domain = games_geo$weather_temperature, reverse = TRUE)"
"0",""
"0","# Create Leaflet map"
"0","leaflet(games_geo) %>%"
"0","  addProviderTiles(providers$CartoDB.Positron) %>%"
"0","  addCircleMarkers("
"0","    lng = ~longitude,"
"0","    lat = ~latitude,"
"0","    radius = ~wind_scaled,"
"0","    color = ~result_color,"
"0","    fillColor = ~temp_pal(weather_temperature),"
"0","    fillOpacity = 0.7,"
"0","    stroke = TRUE,"
"0","    weight = 1,"
"0","    popup = ~paste0("
"0","      ""<strong>"", team_home, "" vs "", team_away, ""</strong><br>"","
"0","      stadium, ""<br>"","
"0","      ""Week "", schedule_week, "" ("", schedule_season, "")<br>"","
"0","      ""Score: "", score_home, "" - "", score_away, ""<br>"","
"0","      ""Temp: "", weather_temperature, ""Â°F<br>"","
"0","      ""Humidity: "", weather_humidity, ""%<br>"","
"0","      ""Wind: "", weather_wind_mph, "" mph<br>"","
"0","      ifelse(home_win, ""ðŸ  Home Win"", ""âŒ Home Loss"")"
"0","    )"
"0","  ) %>%"
"0","  addLegend("
"0","    ""bottomright"","
"0","    pal = temp_pal,"
"0","    values = ~weather_temperature,"
"0","    title = ""Temperature (Â°F)"""
"0","  ) %>%"
"0","  addLegend("
"0","    ""bottomleft"","
"0","    colors = c(""magenta"", ""black""),"
"0","    labels = c(""Home Win"", ""Home Loss""),"
"0","    title = ""Game Result"""
"0","  )"
